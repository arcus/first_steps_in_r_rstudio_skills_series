<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>session_4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/countdown-0.4.0/countdown.css" rel="stylesheet">
<script src="site_libs/countdown-0.4.0/countdown.js"></script>


</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="session_4.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">




<section id="welcome" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="welcome">Welcome</h2>
<p>These slides available at: <a href="https://arcus.github.io/first_steps_in_r_rstudio_skills_series/session_4.html" class="uri">https://arcus.github.io/first_steps_in_r_rstudio_skills_series/session_4.html</a></p>
<ul>
<li>Use keyboard arrow keys to
<ul>
<li>advance ( → ) and</li>
<li>go back ( ← )</li>
</ul></li>
<li>Type “s” to see speaker notes</li>
<li>Type “?” to see other keyboard shortcuts</li>
</ul>
<div class="notes">
<p>As always, I’d like to encourage you to open these slides on your own browser, and this first slide helps with tips for you to use the slide deck.</p>
</div>
</section>
<section id="about-arcus-your-presenter" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="about-arcus-your-presenter">About Arcus / Your Presenter</h2>
<div class="columns v-center-container">
<div class="column small-text" style="width:60%;">
<p>Arcus is an initiative by the Research Institute aimed at promoting data discovery and reuse and increasing research reproducibility.</p>
<ul>
<li>Arcus app: <a href="https://arcus.chop.edu" class="uri">https://arcus.chop.edu</a></li>
<li>Arcus Sharepoint site: <a href="https://chop365.sharepoint.com/sites/Arcus" class="uri">https://chop365.sharepoint.com/sites/Arcus</a></li>
</ul>
<p>Among the many teams in Arcus, I represent Arcus Education!</p>
<p><img src="media/arcus_website.png" class="two-thirds bordered img-fluid" alt="Arcus website which displays tools and services including cohort discovery, arcus archives, data catalog, education and training, scientific projects, and clinical data query."></p>
</div><div class="column small-text" style="width:40%;">
<p><img src="media/arcus_research_data_lifecycle.png" class="img-fluid" alt="A circular diagram showing five project phases, including Discover: explore available data, Plan: plan your research project, Collect: receive your data, Analyze: analyze data in an Arcus lab, and Share: contribute data to archives.">:::</p>
</div><div class="notes">
<p>Thanks again for joining us. As you know, I’m ______ [add pronouns here if you want], and I’ll be leading today’s session.</p>
<p>I’ve already talked about this slide previously, and you have these links, so let’s keep going.</p>
</div><section id="arcus-education" class="level2">
<h2 class="anchored" data-anchor-id="arcus-education">Arcus Education</h2>
<div class="columns v-center-container">
<div class="column small-text" style="width:50%;">
<p><img src="media/arcus_education_page.png" class="bordered img-fluid" alt="Education website page that includes three sections titled Getting Started with Arcus, Learn Data Science Skills, and Curate Your Own Learning Experience."></p>
</div><div class="column small-text" style="width:50%;">
<p>Arcus education provides data science training to researchers …</p>
<p>(and often this is useful to non-researchers too!).</p>
<p><a href="https://arcus.chop.edu/i-want-to/arcus-education" class="uri">https://arcus.chop.edu/i-want-to/arcus-education</a></p>
<p>Email us! <a href="mailto:arcus-education@chop.edu" class="email">arcus-education@chop.edu</a></p>
</div>
</div>
<div class="notes">
<p>We’ve already discussed this previously in other workshop sessions, so I’m going to skip this as well. You can always email us at arcus dash education at chop dot edu to ask about how we can help you!</p>
</div>
</section><section id="first-steps-in-r-and-rstudio" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="first-steps-in-r-and-rstudio">First Steps in R and RStudio</h2>
<p>Arcus Education provides “Skills Series” for the entire CHOP community.</p>
<p>This Skills Series is a 5-session series aimed at helping you take your first steps in R and RStudio!</p>
<ul>
<li>Session 1: Review and Setup</li>
<li>Session 2: Projects and File Ingestion</li>
<li>Session 3: Exploring Data Visually, Using ggplot2</li>
<li>Session 4: Selecting Data Using dplyr</li>
<li>Session 5: Putting it All Together: Communicating</li>
</ul>
<div class="notes">
<p>Just a reminder about what you’re in today.</p>
<p>This is a five-session series, and our goal is to help you get started taking your first steps. Today, we’re in session four, so we’re in the second half of our work together!</p>
</div>
</section><section id="session-4-itinerary" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="session-4-itinerary">Session 4 Itinerary</h2>
<p>Selecting Data Using <code>dplyr</code></p>
<ul>
<li>Selecting columns</li>
<li>Filtering rows</li>
<li>Creating new columns</li>
</ul>
<p>Goals:</p>
<ul>
<li>Describe what a “factor” variable is in R and why it’s important to use it</li>
<li>Use “select” and “filter” to subset data</li>
<li>Use “group by” and “summarize” to get group-level statistics</li>
</ul>
<div class="notes">
<p>What are we going to do today? We’re going to learn about the dplyr package and use it to reshape data, specifically by selecting columns of interest, filtering rows you want to preserve, and creating new columns of data.</p>
<p>My goals for you this session are the following. I really want you to understand what a factor variable is in R and why it can be useful to transform some variables to factor. I want you to successfully use select and filter functions, and I want you to use group by and summarize to get some group level statistics before we leave today.</p>
</div>
</section><section id="but-first-data-types" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="but-first-data-types">But first: data types</h2>
<p>Some atomic data types in R:</p>
<ul>
<li><strong>character</strong>: “ABC”, “True”, “123”</li>
<li><strong>integer</strong> (class = numeric): 123, -3, 0</li>
<li><strong>double</strong> (class = numeric): 123.0, -3.33</li>
<li><strong>logical</strong>: True, False</li>
</ul>
<p>Then there’s the <strong>factor</strong> – it’s a data <strong>structure</strong> but acts like a <strong>data type</strong> in a lot of ways</p>
<p><code>typeof()</code> can give you the data type</p>
<div class="notes">
<p>In today’s exercises, I’m going to have you read in the cirrhosis data and do some corrections related to data types, so before anything else, I want to briefly talk about data types in R. There are lots of books and resources that go into data types in depth, so I won’t do that here. There are a couple of numeric types, one for integers and one for decimals, which is called double, and a character type for strings, but what I really want to draw your eye to is that there are special ways to store some kinds of data that you might not have thought of. For example, there is a logical type which holds truth values, namely, True and False. Not the words “True” and “False” – those would be character – , but the abstract values of True and False.</p>
<p>And there’s also this thing called a factor, which is pretty useful for categorical data. And if you collect data where there are categories, like sex or race or comorbid condition, you want to know about factors.</p>
</div>
</section><section id="factors" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="factors">Factors</h2>
<p>Factors are categorical data. Categorical / factor data are data in which every observation falls into a set number of values (like drug/placebo, male/female/intersex, etc.)</p>
<ul>
<li>Ordered:
<ul>
<li>small / medium / large</li>
<li>stage 1 / stage 2 / stage 3 / stage 4</li>
</ul></li>
<li>Unordered:
<ul>
<li>benign / malignant</li>
<li>Delaware / New Jersey / Pennsylvania</li>
</ul></li>
</ul>
<div class="notes">
<p>In the exercises you’ll be working in today, I want you to use a function we’re going to learn in a few minutes to change some character data, some letters, into factors, and it’s important to understand what factors are and why they can be useful and important.</p>
<p>Factors are categorical data. Factor data are data in which every observation falls into a set number of values. Some categories have a kind of internal order, like small, medium, and large, or disease stage. Some categories don’t have any kind of internal order, like benign or malignant labels or U.S. state.</p>
<p>If your data can be described in a set number of discrete categories, you can make that data into a factor variable in R. And often, you want to! It can make it easy to enforce the number of categories and make sure that new data isn’t introduced because of misspelling, accidentally creating a new category you didn’t want, for example.</p>
</div>
</section><section id="factors-1" class="level2">
<h2 class="anchored" data-anchor-id="factors-1">Factors?</h2>
<p>Are these numbers, characters, or factors?</p>
<ul>
<li>19147</li>
<li>19103</li>
<li>19146</li>
<li>19128</li>
</ul>
<p>How we treat these can matter to R in how it treats these data in terms of modeling!</p>
<div class="notes">
<p>Let’s look at this data. What are these? Are they numbers? Characters? Factors? I haven’t told you what they represent. If these are measurements, like weight in grams, then maybe we should leave these as numbers. But I suspect these are Philadelphia area postal codes.</p>
<p>And if that’s the case, they aren’t really numbers. Yes, these are codes that are made up using numerals, but they don’t represent quantities. They’re just categorical labels for areas of land. We could have called these A, B, C, or purple zone, green zone, and tan zone just as easily.</p>
<p>But if we leave them as numbers, R might try to treat them as numbers and try to account for them that way in a model. A model that tries to treat these as a measure of something that a patient has more or less of would be a bad model that could behave unpredictably.</p>
</div>
</section><section id="dplyr" class="level2">
<h2 class="anchored" data-anchor-id="dplyr">dplyr</h2>
<div class="columns v-center-container">
<div class="column" style="width:50%;">
<p><img src="media/dplyr_logo.png" class="img-fluid"></p>
</div><div class="column" style="width:50%;">
<p>a grammar for transforming data frames</p>
<p><code>library(dplyr)</code> OR <code>library(tidyverse)</code></p>
</div>
</div>
<div class="notes">
<p>OK, so now that we have talked about data types, let’s get into the main topic of the day. <code>dplyr</code> is a play on words with “data” and the useful tool we all have in our toolbox, a pai rof “pliers”. The various functions we’ll use, today are all functions that belong to the <code>dplyr</code> package.</p>
<p>Just as a reminder, in R, we bring in the functionality of a package by using the <code>library()</code> command. Because <code>dplyr</code> forms part of the <code>tidyverse</code>, we can bring in the useful functions of <code>dplyr</code> by either using the <code>library(dplyr)</code> command or the <code>library(tidyverse)</code> command.</p>
<p>As we will see in this last section, each dplyr function takes a data frame, does something with it, and then returns a modified data frame as its output. Because of this, dplyr functions can be strung together to create powerful data analysis pipelines in just a few lines of code.</p>
</div>
</section><section id="subsetting-columns-vs-rows" class="level2">
<h2 class="anchored" data-anchor-id="subsetting-columns-vs-rows">Subsetting Columns vs Rows</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><code>select()</code></p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/dplyr_select.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><code>filter()</code></p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/dplyr_filter.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<div class="notes">
<p>Often, you have a large data frame but want to display or use data from only a small part of it, or you want to pull out some of the data out for a separate use. The <code>dplyr</code> package, part of the larger <a href="https://www.tidyverse.org/">tidyverse</a> set of packages, works great for this purpose.</p>
<p>Let’s look at how you can subset a data frame, that is, choose only certain columns and/or rows from that data, by using <code>dplyr</code>.</p>
<p><code>dplyr</code> provides two functions for subsetting data frames: <code>select()</code> for subsetting columns, and <code>filter()</code> for subsetting rows:</p>
<p><code>select()</code> reshapes data so that it includes only the columns you specify.</p>
<p><code>filter()</code> reshapes data so that it includes only the rows that meet your conditions.</p>
</div>
</section><section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select">select()</h2>
<p>Choose some columns to preserve in a selection.</p>
<p><code>select(data_frame, [column or columns])</code></p>
<div class="notes">
<p>Let’s look at <code>select()</code> first. The <code>select()</code> function extracts <strong>columns</strong> from a data frame, using the columns as argument(s).</p>
<p><code>select()</code> takes a data frame as its first argument. After that it takes one or more arguments that specify the names of the columns that you want to pick.</p>
</div>
</section><section id="select-1" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="select-1">select()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>So we’re going to start with a data frame. You can see here that I haven’t put in all the rows and columns, the ellipses here represent columns I haven’t included, and I’ve only put in the first five rows. But hopefully this is recognizably the cirrhosis dataset.</p>
<p>Let’s say I want a version of this data that only preserves a few columns of this dataset.</p>
</div>
</section><section id="select-2" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="select-2">select()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>select</code> function</strong></p>
<p><code>select(cirrhosis_study, ID, N_Days, Status, Drug)</code> (prints to screen) <code>new_thing &lt;- select(cirrhosis_study, ID, N_Days, Status, Drug)</code> (saves it)</p>
<div class="notes">
<p>Let’s examine the code on this slide.</p>
<p>This <code>select</code> statement will take the data frame <code>cirrhosis_data</code>, and return a new data frame that only has the columns I indicate.</p>
<p>An important point to note here is that <code>select</code> <strong>will not modify the original data frame</strong> but simply returns the altered data frame you asked for. It will simply print out the result in the console or in your R Markdown document. If you want to <strong>capture</strong> the modified data frame you need to <strong>assign</strong> it to a named object using the arrow operator.</p>
<p>In my case, I’m telling the select function to only hang on to four columns in the cirrhosis_study data frame, and I mention them by name. Note that I don’t have to put quotes around these column names, because they refer to objects, in this case, whole columns that the select statement already knows about.</p>
</div>
</section><section id="select-3" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="select-3">select()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>select</code> function</strong></p>
<p><code>select(cirrhosis_study, ID, N_Days, Status, Drug)</code></p>
<p><strong>After</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>Any questions about that?</p>
</div>
</section><section id="participation-time" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="participation-time">Participation Time!</h2>
<p>Which of the following will select the <code>Ascites</code> column from the <code>cirrhosis_study</code> data frame and capture the result in a data frame named <code>newdata</code>?</p>
<p><strong>A)</strong> <code>newdata = select(Ascites, cirrhosis_study)</code></p>
<p><strong>B)</strong> <code>newdata &lt;- select(cirrhosis_study, Ascites)</code></p>
<p><strong>C)</strong> <code>select(newdata, cirrhosis_study, Ascites)</code></p>
<p><strong>D)</strong> <code>newdata &lt;- select(cirrhosis_study, ascites)</code></p>
<p><strong>E)</strong> Both B and D</p>
<div class="cell">
<div class="cell-output-display">
<div class="countdown" id="timer_f2f99144" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">−</button><button class="countdown-bump-up">+</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
</div>
</div>
<div class="notes">
<p>Great, we have some folks saying [whatever], others are suggesting [whatever]. The answer is B.</p>
<p>A isn’t correct, because the arguments are in the wrong order. The first argument in the tidyverse functions we’re studying today is always going to be the data frame you want to work with. That means the first argument should be cirrhosis.</p>
<p>C isn’t correct because you have to use the assignment arrow to save the new, one-column-only data frame to an object called newdata. You don’t pass the name you want to apply to the object as an argument.</p>
<p>D isn’t right because capitalization matters!</p>
<p>So E is also clearly incorrect.</p>
</div>
</section><section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">filter()</h2>
<p>Choose some conditions to filter the rows you want to keep.</p>
<p><code>filter(data_frame, [some condition or conditions for rows])</code></p>
<div class="notes">
<p>One of the most important <code>dplyr</code> functions to know about is <code>filter()</code>. <code>filter()</code> extracts rows, and it does that based on <strong>logical criteria</strong>, or a <strong>condition</strong> that can be evaluated to be true (keep that row as part of our subset) or false (don’t keep that row).</p>
<p>Like <code>select()</code>, <code>filter()</code> takes a data frame as its first argument. The second argument is a condition or logical test. R then performs that logical test on each row of the dataset and returns all rows in which the logical test was true.</p>
<p>To extract rows that meet logical criteria, we write code that looks like this, and we’ll replace the three dots with one or more logical conditions that the row has to meet.</p>
</div>
</section><section id="filter-1" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="filter-1">filter()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>Let’s take a look at an example. Here I have that same shortened version of our cirrhosis data frame, and I want only to look at the subjects who unfortunately died during the course of the study. I’ll filter by their Status, and I want their status to be equal to the letter D.</p>
</div>
</section><section id="filter-2" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="filter-2">filter()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>filter</code> function</strong></p>
<p><code>filter(cirrhosis_study, Status == "D")</code></p>
<div class="notes">
<p>Notice that I put the letter D in quotes, because it’s possible that I have a variable or a data frame in my environment. For example, maybe D is set equal to the name “David”, or something like that. But that’s not what I want. I’m not referring to some object called D that R should be looking for, I mean the literal letter D. So I put it in quotes.</p>
<p>Notice that we’re using a double equals here. That’s very important!</p>
</div>
</section><section id="filter-3" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="filter-3">filter()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>filter</code> function</strong></p>
<p><code>filter(cirrhosis_study, Status == "D")</code></p>
<p><strong>After</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
</tbody>
</table>
<div class="notes">

</div>
</section><section id="a-potential-pitfall" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="a-potential-pitfall">A Potential Pitfall!</h2>
<div class="code-block warning-red">
<p>Error: Problem with <code>filter()</code> input <code>..1</code>. x Input <code>..1</code> is named. ℹ This usually means that you’ve used <code>=</code> instead of <code>==</code>.</p>
</div>
<p>OR</p>
<div class="code-block warning-red">
<p>Error: unexpected ‘=’</p>
</div>
<p>OR</p>
<div class="code-block warning-red">
<p>invalid (do_set) left-hand side to assignment</p>
</div>
<div class="notes">
<p>One common issue to be aware of is the difference between the single equals and the double equals operators.</p>
<p>In R, using a single equals sign assigns a value. It demands, “make these things equal.”</p>
<p>The double equals sign does not assign, but compares. It asks “<strong>are</strong> these things equal?”.</p>
<p>That’s why we use double equals in the context of a logical test that compares two values.</p>
<p>If you use the wrong kind of equals, you’ll get an error. This is a very common mistake, and one you’re almost guaranteed to accidentally commit at one point or another! This is what some of those scary errors look like!</p>
</div>
</section><section id="logical-operators" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="logical-operators">Logical Operators</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 35%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">logical expression</th>
<th>means</th>
<th>example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>x &lt; y</code></td>
<td>less than</td>
<td><code>Cholesterol &lt; 200</code>.</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>x &gt; y</code></td>
<td>greater than</td>
<td><code>N_Days &gt; 3000</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>x == y</code></td>
<td>equal to</td>
<td><code>Ascites == Edema</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>x &lt;= y</code></td>
<td>less than or equal to</td>
<td><code>Bilirubin &lt;= 2.0</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>x &gt;= y</code></td>
<td>greater than or equal to</td>
<td><code>Copper &gt;= 100</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>x != y</code></td>
<td>not equal to</td>
<td><code>Status != "D"</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>is.na(x)</code></td>
<td>a missing value</td>
<td><code>is.na(Platelets)</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>!is.na(x)</code></td>
<td>not a missing value</td>
<td><code>!is.na(SGOT)</code></td>
</tr>
</tbody>
</table>
<div class="notes">
<p>Here are some important logical operators to know about. They will all come in handy when you’re filtering rows of a data frame. <code>x</code> and <code>y</code> each represent expressions, which could be column names or constant values or a combination thereof.</p>
<p>We’ve already seen the double equals. There are also the less than or and greater than operators. These operators also come as “or equal to” versions.</p>
<p>Use exclamation point equals (some people say “bang equals”) if you want to select rows in which a value is <strong>not</strong> equal to another value.</p>
<p><code>is.na()</code> is how you can test for missing values (<code>NA</code> in R). This comes in handy when you want to remove missing values from your data, which we’ll see later.</p>
</div>
</section><section id="your-turn" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="your-turn">Your Turn</h2>
<p>Which of these would successfully filter the <code>cirrhosis_study</code> data frame to only subjects who received the placebo?</p>
<p><strong>A)</strong> <code>filter(cirrhosis_study, Drug == Placebo)</code></p>
<p><strong>B)</strong> <code>filter(cirrhosis_study, Drug = "Placebo")</code></p>
<p><strong>C)</strong> <code>filter(cirrhosis_study, Drug == "Placebo")</code></p>
<p><strong>D)</strong> <code>filter(cirrhosis_study, drug == "Placebo")</code></p>
<div class="cell">
<div class="cell-output-display">
<div class="countdown" id="timer_8822542c" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">−</button><button class="countdown-bump-up">+</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
</div>
</div>
<div class="notes">
<p>Here we have another multiple choice to see if you’re on your toes. Only one of these is correct? Which one? Post what you think in chat.</p>
<hr>
<p>A is wrong because “Placebo” is a character string (it’s not a named object or a number, it’s a string that needs to be quoted). B is wrong because you’re trying to do a comparison with a single equals. C is correct! D is wrong because of capitalization.</p>
</div>
</section><section id="the-pipe-operator-or" class="level2">
<h2 class="anchored" data-anchor-id="the-pipe-operator-or">The Pipe Operator %&gt;% or |&gt;</h2>
<p>The pipe operator is <code>%&gt;%</code> (from the <code>magrittr</code> package, part of the <code>tidyverse</code>), or <code>|&gt;</code> (part of base R starting with version 4.1.0).</p>
<div class="notes">
<p>Let’s talk about the pipe operator, which we can use to build pipelines!</p>
<p>One of the most powerful concepts in the <code>tidyverse</code> suite of packages is the pipe operator, which is written in two possible ways:</p>
<ul>
<li>percent, greater than, percent (<code>%&gt;%</code>) (this is the original pipe which gets included as part of <code>dplyr</code> and <code>tidyverse</code>)</li>
<li>vertical pipe, greater than (<code>|&gt;</code>) (this is a newer option, and is now “native”, meaning it comes from base R, if you’re using R version 4.1.0 or later)</li>
</ul>
</div>
</section><section id="the-pipe-operator" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="the-pipe-operator">The Pipe Operator</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/pipe_mini.png" class="half img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="small-text">
<p>Passes the <strong>object on the left</strong> as the <strong>first argument</strong> to the <strong>function on the right</strong></p>
<p><code>cirrhosis %&gt;% filter(Bilirubin &lt;= 3)</code> is equivalent to <code>filter(cirrhosis_study, Bilirubin &lt;= 3)</code></p>
<p>OR, if you use the newer pipe:</p>
<p><code>cirrhosis |&gt; filter(Bilirubin &lt;= 3)</code> is equivalent to <code>filter(cirrhosis_study, Bilirubin &lt;= 3)</code></p>
</div>
<div class="notes">
<p>Both pipe operators pass the <strong>object on its left</strong> as the <strong>first argument</strong> to the <strong>function on its right</strong>.</p>
<p>In this workshop, we’ll use both kinds of pipe in code examples and quiz questions, so that you get used to seeing them both.</p>
<p>Those two lines of code are equivalent.</p>
<p>In both cases we’re taking the data frame, passing it as the first argument to the <code>filter()</code> function, and adding a condition that we’re filtering by.</p>
<p>We could say the same thing of the second line of blue code on your screen which uses the newer pipe.</p>
</div>
</section><section id="pipes-make-output-into-the-next-input" class="level2">
<h2 class="anchored" data-anchor-id="pipes-make-output-into-the-next-input">Pipes make Output into the next Input!</h2>
<pre><code>cirrhosis %&gt;%
  filter(Copper &gt;= 100) %&gt;%
  select(Bilirubin, Platelets, Stage)</code></pre>
<ul>
<li>Start with the <code>cirrhosis</code> data frame. <strong>THEN</strong>, to that:</li>
<li>Filter so that we get only certain rows <strong>THEN</strong>, to that:</li>
<li>Select so that we get only certain columns.</li>
</ul>
<div class="notes">
<p>Here’s why the pipe (<code>%&gt;%</code> or <code>|&gt;</code>) is so useful.</p>
<p>“Tidy” functions like <code>select()</code>, <code>filter()</code>, and others we’ll see later always have as first argument a data frame, and they always return a data frame as well. Data frame in, data frame out.</p>
<p>This makes it possible to create a <strong>pipeline</strong> in which a data frame object is handed from one <code>dplyr</code> function to the next. The data frame result of step 1 becomes the data frame starting point for step 2, then the result of step 2 becomes the starting point for step 3, and so on.</p>
<p>You might wonder why we’ve put each step in its own line. Is this a requirement? No, it’s not. Many R users like to use <strong>whitespace</strong> (new lines, tabs, spaces, indents) to make their code more human readable.</p>
<p>By connecting logical steps, you can get a <strong>pipeline</strong> of data analysis steps which are concise and also fairly human readable. You can think of the pipe symbol as the word “then…”, describing the steps in order.</p>
<p>This approach to coding is powerful because it makes it much easier for someone who doesn’t know R well to read and understand your code as a series of instructions.</p>
<p>I want to ask you… could I change the order of the select and filter steps here? Why or why not?</p>
</div>
</section><section id="your-turn-1" class="level2 smaller" data-background-color="#e3faf1">
<h2 class="smaller anchored" data-background-color="#e3faf1" data-anchor-id="your-turn-1">Your Turn</h2>
<p>Rewrite (in your head or jot down) the following statement with a pipe:</p>
<p><code>select(mydata, first_name, last_name)</code></p>
<div class="cell">
<div class="cell-output-display">
<div class="countdown" id="timer_5a8782a1" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">−</button><button class="countdown-bump-up">+</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">01</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
</div>
</div>
<div class="notes">
<p>OK, I want to see if you grasp this concept, as it’s pretty important, moving forward. How would you rewrite the statement on your screen, select mydata comma first name comma last name, and use the pipe syntax instead? Share what you think the answer is.</p>
<p>…</p>
<p>Yep, that’s exactly right! You’d write mydata, the pipe symbol, and then select first name comma last name. Any questions on that?</p>
</div>
</section><section id="your-turn-2" class="level2 smaller" data-background-color="#e3faf1">
<h2 class="smaller anchored" data-background-color="#e3faf1" data-anchor-id="your-turn-2">Your Turn</h2>
<p>Rewrite (in your head or jot down) the following statement with a pipe:</p>
<p><code>select(mydata, first_name, last_name)</code></p>
<p><code>my_data %&gt;% select(first_name, last_name)</code></p>
<p>(OR you might also see or use)</p>
<p><code>my_data |&gt; select(first_name, last_name)</code></p>
</section><section id="mutate" class="level2">
<h2 class="anchored" data-anchor-id="mutate">mutate()</h2>
<p>Create new or updated, optionally calculated columns.</p>
<p><code>mutate(data_frame, [name = value])</code></p>
<div class="notes">
<p>Let’s say you want to add a new column to your data frame, or update a column by changing it in some way (say, convert kilograms to pounds). dplyr has a function for that, too!</p>
<p><code>mutate()</code> is an extremely useful <code>dplyr</code> function, and you can use it to make new variables / columns. That’s what we’ll use it for here. You can also use <code>mutate()</code> to change existing columns (say, turn an entire column lowercase or round or scale a numeric value).</p>
<p>Like all <code>dplyr</code> functions, <code>mutate()</code> takes a data frame as its first argument. After that, you tell it what to name the new column and what should be in it. This is done using <strong>name-value expressions</strong>.</p>
<p>In <strong>name-value expression</strong>, you have:</p>
<ul>
<li>a name</li>
<li>an equals sign (<code>=</code>), and</li>
<li>a value</li>
</ul>
</div>
</section><section id="mutate-1" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="mutate-1">mutate()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>OK, so let’s say that I want to understand more intuitively how long my subjects stayed in the trial, and I want to see the number of years, not just the number of days, they stayed. I want to make a new column that I’ll create by converting N_Days to Years by dividing that by 365.25 and then rounding to two decimal places.</p>
</div>
</section><section id="mutate-2" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="mutate-2">mutate()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>mutate</code> function</strong></p>
<p><code>mutate(cirrhosis_study, N_Years = round(N_Days / 365.25, 2))</code></p>
<div class="notes">
<p>I’ll give my new column a name, N_Years. I don’t really love capitals in my variable names, but I think consistency is the lesser evil here. And I’ll give the calculation. Take the N_Days column, divide it by 365.25, round that to two decimal places, and that’s the value of the new column.</p>
</div>
</section><section id="mutate-3" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="mutate-3">mutate()</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>mutate</code> function</strong></p>
<p><code>mutate(cirrhosis_study, N_Years = round(N_Days / 365.25, 2))</code></p>
<p><strong>After</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
<th>N_Years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
<td>1.1</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
<td>12.32</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
<td>2.77</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
<td>5.27</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
<td>4.12</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>And you can see that it’s put it at the end here. But let me show you a trick on how to fix that!</p>
</div>
</section><section id="piping-it-all-together" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="piping-it-all-together">Piping it all together</h2>
<ul>
<li>Reduce columns to just a few</li>
<li>Reduce rows ()</li>
<li>Add new column</li>
<li>Reorder the columns so it makes better sense</li>
</ul>
</section><section id="piping-it-all-together-1" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="piping-it-all-together-1">Piping it all together</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>As per usual, we’ll start here.</p>
</div>
</section><section id="piping-it-all-together-2" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="piping-it-all-together-2">Piping it all together</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>Age</th>
<th>Sex</th>
<th>…</th>
<th>Tryglicerides</th>
<th>Platelets</th>
<th>Prothrombin</th>
<th>Stage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>21464</td>
<td>F</td>
<td>…</td>
<td>172</td>
<td>190</td>
<td>12.2</td>
<td>4</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
<td>20617</td>
<td>F</td>
<td>…</td>
<td>88</td>
<td>221</td>
<td>10.6</td>
<td>3</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>25594</td>
<td>M</td>
<td>…</td>
<td>55</td>
<td>151</td>
<td>12</td>
<td>4</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>19994</td>
<td>F</td>
<td>…</td>
<td>92</td>
<td>183</td>
<td>10.3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
<td>13918</td>
<td>F</td>
<td>…</td>
<td>72</td>
<td>136</td>
<td>10.9</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>select</code> function</strong></p>
<p><code>cirrhosis |&gt;</code></p>
<p><code>select(ID, N_Days, Status, Drug)</code></p>
<p><strong>After</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>So our first step is to take the cirrhosis data frame and then push that through a pipe to a select function, where we winnow it down to just a few columns. This “after” is going to become the “before” of our next step!</p>
</div>
</section><section id="piping-it-all-together-3" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="piping-it-all-together-3">Piping it all together</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>2</td>
<td>4500</td>
<td>C</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1504</td>
<td>CL</td>
<td>Placebo</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>select</code> and <code>filter</code> functions</strong></p>
<p><code>cirrhosis |&gt;</code></p>
<p><code>select(ID, N_Days, Status, Drug) |&gt;</code></p>
<p><code>filter(Status == "D")</code></p>
<p><strong>After</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>In our filter step, we START with what we ended with at the end of our select step. We filter from that!</p>
</div>
</section><section id="piping-it-all-together-4" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="piping-it-all-together-4">Piping it all together</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>select</code>, <code>filter</code>, and <code>mutate</code> functions</strong></p>
<p><code>cirrhosis |&gt;</code></p>
<p><code>select(ID, N_Days, Status, Drug) |&gt;</code></p>
<p><code>filter(Status == "D") |&gt;</code></p>
<p><code>mutate(N_Years = round(N_Days/365.25,2))</code></p>
<p><strong>After</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>N_Years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>1.1</td>
</tr>
<tr class="even">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>2.77</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>5.27</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>OK, so again our “after” from last step became our “before for this step, and we’ve used mutate to add a column. We’re getting really close. But we want our columns to be in a different order! Let’s use”select” again!</p>
</div>
</section><section id="piping-it-all-together-5" class="level2 tiny-text">
<h2 class="tiny-text anchored" data-anchor-id="piping-it-all-together-5">Piping it all together</h2>
<p><strong>Before</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>Status</th>
<th>Drug</th>
<th>N_Years</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>D</td>
<td>D-penicillamine</td>
<td>1.1</td>
</tr>
<tr class="even">
<td>3</td>
<td>1012</td>
<td>D</td>
<td>D-penicillamine</td>
<td>2.77</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1925</td>
<td>D</td>
<td>D-penicillamine</td>
<td>5.27</td>
</tr>
</tbody>
</table>
<p><strong>Using the <code>select</code>, <code>filter</code>, <code>mutate</code>, and <code>select</code> again functions</strong></p>
<p><code>cirrhosis |&gt;</code></p>
<p><code>select(ID, N_Days, Status, Drug) |&gt;</code></p>
<p><code>filter(Status == "D")  |&gt;</code></p>
<p><code>mutate(N_Years = round(N_Days/365.25,2)) |&gt;</code></p>
<p><code>select(ID, starts_with("N_"), everything())</code></p>
<p><strong>After</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>ID</th>
<th>N_Days</th>
<th>N_Years</th>
<th>Status</th>
<th>Drug</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>400</td>
<td>1.1</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="even">
<td>3</td>
<td>1012</td>
<td>2.77</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1925</td>
<td>5.27</td>
<td>D</td>
<td>D-penicillamine</td>
</tr>
</tbody>
</table>
<div class="notes">
<p>I’m introducing some tricks here. I could have just put the columns by name in that last select statement: ID comma N Days comma N Years comma Status comma Drug. But what if I had fifty columns, not five? That could be annoying. I wanted to introduce you to a couple of helper functions. starts_with (and there’s also ends_with and contains) can help you get all of the variables that have a certain naming pattern. And “everything” in this context gets everything that hasn’t already been mentioned by name.</p>
</div>
</section><section id="group-by-and-summarize" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="group-by-and-summarize">Group By and Summarize</h2>
<p>A very common use case is to divide your data into groups, and get information about each group.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/group_by_summarise_mini.png" class="half img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="notes">
<p>Group by combined with summarize is a way for us to lump cases together and then get a statistic for each group. For example, maybe you want the median blood sugar for girls and the median blood sugar for boys in your study, or the maximum wait time for King of Prussia emergency department patients and the maximum wait time for University City emergency department patients.</p>
<p>When you use group by, you have to tell R how to separate your cases into groups. In the image here, there are three groups, each of which is represented by a different shade of gold. Any variable that is categorical data can be used to group. For example, you can group by sex, or race, or zip code. Maybe these three groups are three states, like New Jersey, Pennsylvania, and Delaware!</p>
<p>Once you have your data in groups, you can then use the summarize command to get summary statistics for each group. The summary for each group is represented in blue in this small image.</p>
<p>Summarizing can take lots of different forms! Sometimes you want to know how big the group is, how many members it has. Sometimes you want to know what the average value of something is per group, or what the maximum value is. You can also summarize and give several different measures for each group, like maximum, minimum, mean, and median. It looks like in this image there are two values given for each group. Maybe we have two values for New Jersey, Pennsylvania and Delaware, like the number of patients we have in each state and the number of patients in each state using Medicaid.</p>
</div>
</section><section id="group-by-and-summarize-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="group-by-and-summarize-1">Group By and Summarize</h2>
<p>Note that when you do math on null values (NA) in R, the answer is always NA, so a lot of times in R you have to explicitly say “remove the NA values” in order to get a value.</p>
<p>This code appears in your exercise file, so you can try it there!</p>
<pre><code>cirrhosis |&gt;
  group_by(Hepatomegaly) |&gt;
  summarize(Mean_Cholesterol = mean(Cholesterol, na.rm = TRUE), 
            Median_Cholesterol = median(Cholesterol, na.rm = TRUE))</code></pre>
</section><section id="your-turn-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="your-turn-3">Your Turn!</h2>
<ul>
<li>Go to https://posit.cloud and log in.</li>
<li>Find your First Steps in R and RStudio project and open it</li>
<li>In the file browser (lower right), navigate to Exercises</li>
<li>Open session_4_exercise.qmd, and start reading and working in it!</li>
<li>If you <strong>save</strong> this file, save it with your initials at the end (rename it).</li>
<li>If you get stuck, there’s a solutions file in the “solutions” folder, or jump into chat!</li>
<li>I’d love for everyone to work quietly for around 15 minutes, and then I’ll demo some of the solution.</li>
<li>I’ll stop us all for a couple of closing slides and for Q&amp;A as we get close to the end of the hour.</li>
</ul>
</section><section id="recap" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="recap">Recap</h2>
<div class="columns centered" width="80%">
<div class="column" style="width:25%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/select_mini.png" class="two-thirds img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div><div class="column" style="width:75%;">
<p><code>select()</code> subsets columns by name</p>
</div>
</div>
<div class="columns centered" width="80%">
<div class="column" style="width:25%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/filter_mini.png" class="two-thirds img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div><div class="column" style="width:75%;">
<p><code>filter()</code> subsets rows by a logical condition</p>
</div>
</div>
<div class="columns centered" width="80%">
<div class="column" style="width:25%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/mutate_mini.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div><div class="column" style="width:75%;">
<p><code>mutate()</code> creates new calculated columns or changes existing columns</p>
</div>
</div>
<div class="columns centered" width="80%">
<div class="column" style="width:25%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/pipe_mini_1.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div><div class="column" style="width:75%;">
<p>Use the pipe operator <code>%&gt;%</code> to combine dplyr functions into a pipeline</p>
</div>
</div>
<div class="columns centered" width="80%">
<div class="column" style="width:25%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/group_by_summarise_mini.png" class="two-thirds img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div><div class="column" style="width:75%;">
<p><code>group_by()</code> with <code>summarize()</code> gives per-group statistics</p>
</div>
</div>
<div class="notes">
<p>To recap, <code>dplyr</code> is a package you can load in R that provides a grammar for transforming data frames. Some of the key <code>dplyr</code> functions are:</p>
<p><code>select()</code>, which subsets columns by name <code>filter()</code>, which subsets rows by a logical condition, and <code>mutate()</code>, which creates new calculated columns or changes existing columns</p>
<p>Additionally, <code>dplyr</code> and other <code>tidyverse</code> packages make use of the pipe operator, which can be used to string together <code>dplyr</code> functions into a pipeline that performs several transformations.</p>
<p>Finally, <code>group_by()</code> and <code>summarize()</code> work together to allow you to calculate per-group summary statistics.</p>
</div>
</section><section id="cheatsheet-more-dplyr-functions" class="level2">
<h2 class="anchored" data-anchor-id="cheatsheet-more-dplyr-functions">Cheatsheet (more dplyr functions!)</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="media/dplyr_cheatsheet_snapshot.png" class="two-thirds bordered img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="notes">
<p>RStudio creates and distributes a number of cheatsheets for various purposes. You can find them by clicking in the <strong>Help menu</strong> in RStudio – try that now! Here’s an image of the <code>dplyr</code> cheatsheet. As you can see, there are lots of other functions that dplyr offers.</p>
<p>Other <code>dplyr</code> functions include <code>arrange()</code>, <code>distinct()</code>, <code>group_by()</code> (which is especially helpful when combined with <code>summarize()</code>), and many more!</p>
</div>
</section><section id="summary-of-today" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="summary-of-today">Summary of Today</h2>
<p>Today, you:</p>
<ul>
<li>Learned about file types</li>
<li>Learned about dplyr and its functions</li>
<li>Built pipelines of select, filter, and mutate</li>
<li>Worked with factor variables</li>
<li>Possibly learned new things about working in RStudio, like chunk names</li>
</ul>
<p>That’s a lot! Give yourselves a round of applause.</p>
<div class="notes">
<p>OK, so that’s session 4. Today, we talked about dplyr And you did a lot of hands-on work, too! If you have a feeling word you want to drop into chat, I’d love to know how today left you feeling!</p>
</div>
</section><section id="qa-was-this-effective" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="qa-was-this-effective">Q&amp;A / Was This Effective?</h2>
<p>We like to measure our effectiveness (and analyze it in R!)</p>
<p>Goals:</p>
<ul>
<li>Describe what a “factor” variable is in R and why it’s important to use it</li>
<li>Use “select” and “filter” to subset data</li>
<li>Use “group by” and “summarize” to get group-level statistics</li>
</ul>
<div class="notes">
<p>The Arcus education team is a group that likes to measure our effectiveness and make changes based on what we learn. So before we do questions and answers and our final slides, we like to make sure to give our learners a poll to see if we made a good use of your time. We’re going to ask if we were effective in reaching our goals today, and those goals are on the screen in order to help you answer that question. Once you answer that poll, feel free to type a question into chat or come off mute and ask to clarify anything I can explain a bit better.</p>
</div>
</section><section id="next-session" class="level2">
<h2 class="anchored" data-anchor-id="next-session">Next Session</h2>
<p>Bringing it all together!</p>
<p>Scientific communication and data visualization in a notebook</p>
<div class="notes">
<p>In our next session, we’re going to build a final notebook together, where you have some independent work and get to make your own decisions on what to look at and prioritize. I’m looking forward to seeing you there. Thanks so much for your hard work today. If you have questions between today and next week, feel free to email me at paytonk@chop.edu or arcus-education@chop.edu, and have a great rest of your day!</p>
</div>


</section>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>